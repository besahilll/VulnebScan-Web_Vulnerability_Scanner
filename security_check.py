
import requests

def get_security_headers(url):
    try:
        response = requests.get(url)
        return response.headers
    except requests.exceptions.RequestException as e:
        print("Error occurred while fetching security headers:", e)
        return None
    except socket.gaierror as e:
        print("Error resolving domain name:", e)
        return None

def check_security(security_headers):
    required_headers = [
        ('Content-Security-Policy', "XSS attacks"),
        ('Strict-Transport-Security', "Man-in-the-middle attacks"),
        ('X-Frame-Options', "Clickjacking attacks"),
        ('X-XSS-Protection', "XSS attacks"),
        ('X-Content-Type-Options', "MIME-sniffing attacks"),
        ('Referrer-Policy', "Information leakage"),
    ]

    vulnerable = False
    missing_headers = []

    for header, risk in required_headers:
        if header not in security_headers:
            vulnerable = True
            missing_headers.append((header, risk))

    if vulnerable:
        print("The website is vulnerable to the following risks:")
        for header, risk in missing_headers:
            print(f"Vulnerable to {risk}: {header} not present")
    else:
        print("The website is not vulnerable. All required security headers are present.")
